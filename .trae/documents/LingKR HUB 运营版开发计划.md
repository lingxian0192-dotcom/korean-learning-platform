# LingKR HUB 运营版开发计划

本计划旨在将现有的 Demo 升级为正式运营版本，核心目标是**建立准入机制（邀请制）**、**增强核心学习功能（个人词库/背单词/AI）以及**提升系统的安全性与商业化形象。

## 阶段一：基础架构与品牌重塑 (Infrastructure & Branding)

此阶段主要完成数据库的底层建设和品牌形象的统一。

1. **数据库架构升级 (Supabase SQL)**

   * 创建 `public.profiles` 表：用于存储用户扩展信息（角色、邀请状态、词汇量统计）。

   * 创建 `public.invitation_codes` 表：存储邀请码及其状态（未使用/已使用/禁用）。

   * 创建 `public.vocab_items` 表：存储用户单词、短语、例句。

   * 创建 `public.study_reviews` 表：基于艾宾浩斯曲线记录复习进度。

   * 创建 `public.api_usage_logs` 表：监控 AI API 用量。

   * **迁移策略**：编写脚本将现有用户自动标记为“已邀请”且赋予“普通用户”权限。
2. **品牌去 Trae 化 (Rebranding)**

   * 移除 `vite-plugin-trae-solo-badge`。

   * 修改 `index.html` 标题为 "LingKR HUB"。

   * 替换 Favicon 和 Manifest 图标。

   * 全局替换 UI 中的 "Trae" 字样为 "LingKR"。

## 阶段二：安全准入与权限系统 (Security & Access Control)

此阶段重点解决“陌生人无法访问”和“后台权限隔离”的问题。

1. **邀请码系统后端 (NestJS)**

   * 实现 `InvitationModule`：生成、验证、核销邀请码。

   * 修改注册/登录流程：

     * 注册时强制校验邀请码（现有用户除外）。

     * 在 `SupabaseGuard` 中增加“是否激活”的检查。
2. **RBAC 权限控制**

   * 实现 `RolesGuard`：区分 `admin` 和 `user` 角色。

   * **强制隔离**：非管理员用户请求 `/admin/*` 接口直接返回 403 Forbidden。
3. **前端认证增强**

   * 重构登录/注册页面：增加邀请码输入框（支持通过 URL 参数自动填入）。

   * 会话管理：实现“单设备登录”逻辑（利用 Supabase 实时订阅或 Token 版本号机制）。

   * 增加“退出登录”确认弹窗。

## 阶段三：核心学习功能开发 (Core Learning Features)

这是本次更新的功能重头戏，独立于资源中心。

1. **个人词库 (Vocabulary Bank)**

   * **后端**：实现单词的增删改查，限制每人 20,000 条上限。

   * **前端**：

     * 开发“词库管理”面板：支持列表视图、搜索、筛选（按词性/标签）。

     * 添加功能：支持添加单词、短语、句子。
2. **艾宾浩斯背单词 (Ebbinghaus SRS)**

   * **算法实现**：基于间隔重复算法（SM-2 简化版），计算下一次复习时间。

   * 词书来源：由用户从个人词库中导入，系统默认提供3套TOPIK初级，中级，高级的词书

   * **复习模式**：

     * 开发“卡片复习”界面（类似“不背单词”，要做电脑&手机版适配，）。

     * 显示：单词 -> **发音**->遮挡释义 -> 点击显示 -> 选择“认识/不认识” -> 更新复习时间。
3. **UI/UX 重构**

   * 引入扁平化设计风格（Flat UI）。

   * 增加动态交互（如卡片翻转动画、进度条动态效果）。

## 阶段四：AI 智能助手集成 (DeepSeek Integration)

接入 AI 辅助学习，严格限制用途。

1. **AI 后端服务**

   * 集成 DeepSeek API。

   * **Prompt Engineering**：设置 System Prompt，严格限制 AI 仅回答韩语学习相关问题（"你是一个韩语助教..."）。

   * **风控**：记录每个用户的 Token 消耗，设置每日限额，防止滥用。
2. **前端 AI 助手**

   * 全局悬浮球或侧边栏入口。

   * 功能联动：在“背单词”界面可点击“AI 助记”，让 AI 生成记忆口诀或例句。

## 阶段五：管理后台与运维 (Admin Dashboard)

完善管理员的上帝视角。

1. **后台功能增强**

   * **邀请码管理**：批量生成、导出、查看使用人、封禁邀请码。

   * **监控面板**：

     * 服务器状态（简单健康检查）。

     * 数据库连接数/容量概览。

     * DeepSeek API 今日消耗与费用预估。
2. **前端路由保护**

   * 使用 `<RequireAdmin>` 组件包裹所有管理后台路由，普通用户无法通过 URL 强行访问。

***

**技术说明 (对于非技术人员)**：

* **数据库**：我们就像给 Excel 表格增加了几页新的 Sheet，专门存单词和邀请记录。

* **邀请制**：就像给大门装了门禁卡，老员工（现有用户）由于系统升级自动发卡，新访客必须有邀请函才能办卡进门。

* **AI 限制**：我们会给 AI 戴上“紧箍咒”，如果用户问它“怎么做菜”，它会拒绝回答，只专注教韩语。

